import{r as a,j as t,B as p,o as O,p as o,A as P}from"./index-GbOaGgM0.js";import{C as b}from"./config-global-BwHnWRtc.js";import{X as T}from"./index.es-CeEWRC6t.js";import{g as q,E as m,p as R}from"./apiClient-i189rV0m.js";import{D as I}from"./content-OnO3XI0R.js";import{D as L,a as N,b as k}from"./DialogContent-lvUHi1mO.js";import{T as z}from"./TextField-BrPYWE6M.js";import{D as B}from"./DialogActions-DbEpsrDh.js";import{C as V}from"./Chip-DLB2M0Hz.js";import"./Select-BaJTgM_p.js";function $(){const[A,c]=a.useState([]),[v,h]=a.useState(!1),[j,r]=a.useState(null),[_,i]=a.useState(!1),[d,u]=a.useState(""),[n,x]=a.useState(null),C="http://172.93.223.239:3001",g=a.useCallback(async()=>{try{h(!0);const e=await q(`${m.GET_APPROVALS_REQUEST}?organiser=true`,{authRequired:!0});c(e.data.organiserRequests||[])}finally{h(!1)}},[]);a.useEffect(()=>{g()},[g]);const y=async e=>{try{r(e),await R(m.APPROVAL_ACTION,{approvalId:e,action:"approved"},{authRequired:!0}),c(s=>s.filter(l=>l._id!==e))}finally{r(null)}},E=e=>{x(e),u(""),i(!0)},S=async()=>{if(n)try{r(n._id),await R(m.APPROVAL_ACTION,{approvalId:n._id,action:"rejected",reason:d},{authRequired:!0}),c(e=>e.filter(s=>s._id!==n._id)),i(!1),x(null),u("")}finally{r(null)}},D=[{name:"User",cell:e=>{var s,l,f;return t.jsxs(p,{sx:{display:"flex",alignItems:"center",gap:1},children:[t.jsx(P,{src:(s=e.user_id)!=null&&s.image?`${C}${(l=e.user_id)==null?void 0:l.image}`:"",sx:{width:36,height:36}}),(f=e.user_id)==null?void 0:f.name]})}},{name:"Email",selector:e=>{var s;return(s=e.user_id)==null?void 0:s.email}},{name:"Phone",selector:e=>{var s;return(s=e.user_id)==null?void 0:s.phone}},{name:"Type",selector:e=>e.type,width:"120px"},{name:"Status",cell:e=>t.jsx(V,{label:e.status,size:"small",color:e.status==="approved"?"success":e.status==="rejected"?"error":"warning"})},{name:"Requested At",selector:e=>new Date(e.createdAt).toLocaleDateString()},{name:"Action",width:"200px",cell:e=>t.jsxs(p,{sx:{display:"flex",gap:1},children:[t.jsx(o,{size:"small",color:"success",variant:"contained",disabled:j===e._id,onClick:()=>y(e._id),children:"Approve"}),t.jsx(o,{size:"small",color:"error",variant:"outlined",disabled:j===e._id,onClick:()=>E(e),children:"Reject"})]})}];return t.jsxs(I,{children:[t.jsx(p,{sx:{mb:3},children:t.jsx(O,{variant:"h4",children:"Organiser Approval Requests"})}),t.jsx(T,{columns:D,data:A,progressPending:v,pagination:!0,highlightOnHover:!0,responsive:!0}),t.jsxs(L,{open:_,onClose:()=>i(!1),maxWidth:"sm",fullWidth:!0,children:[t.jsx(N,{children:"Reject Organizer"}),t.jsx(k,{children:t.jsx(z,{fullWidth:!0,multiline:!0,rows:4,label:"Reject reason",placeholder:"Enter rejection reason...",value:d,onChange:e=>u(e.target.value)})}),t.jsxs(B,{children:[t.jsx(o,{onClick:()=>i(!1),children:"Cancel"}),t.jsx(o,{variant:"contained",color:"error",disabled:!d.trim(),onClick:S,children:"Reject"})]})]})]})}function K(){return t.jsxs(t.Fragment,{children:[t.jsx("title",{children:`Events - ${b.appName}`}),t.jsx($,{})]})}export{K as default};
