import{r as n,j as e,V as R,B as y,e as v,h as p,I as E,A as I}from"./index-D_BIVNvs.js";import{C as _}from"./config-global-BwHnWRtc.js";import{S,L as T,p as O,E as A,g as N,X as B}from"./Switch-C_hsj8f1.js";import{D as Y}from"./SwitchBase-DqRJgKOh.js";import{T as F}from"./TextField-tq51cv8I.js";import{F as k}from"./FormControlLabel-B0WkQfIK.js";import"./Select-D4Ttt0nZ.js";function L({open:b,onClose:r,onSuccess:x}){const[C,c]=n.useState(!1),[d,s]=n.useState(null),[u,h]=n.useState({name:"",description:"",isActive:!0,isFeatured:!1}),l=i=>{const{name:a,value:o,checked:m,type:f}=i.target;h(j=>({...j,[a]:f==="checkbox"?m:o}))},g=async()=>{c(!0);try{const i=new FormData;Object.entries(u).forEach(([o,m])=>i.append(o,String(m))),d&&i.append("image",d);const a=await O(A.ADD_CATEGORY,i,{authRequired:!0,headers:{"Content-Type":"multipart/form-data"}});x(a.data.message||"Category added"),r()}finally{c(!1)}};return e.jsx(R,{open:b,onClose:r,children:e.jsxs(y,{sx:{width:420,p:3,bgcolor:"background.paper",borderRadius:2,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:[e.jsx(v,{variant:"h6",mb:2,children:"New Category"}),e.jsx(F,{fullWidth:!0,label:"Name",name:"name",value:u.name,onChange:l,margin:"normal"}),e.jsxs(p,{component:"label",variant:"outlined",sx:{my:2},children:[d?d.name:"Upload icon",e.jsx("input",{hidden:!0,type:"file",accept:"image/*",onChange:i=>{var a;return s(((a=i.target.files)==null?void 0:a[0])||null)}})]}),e.jsx(F,{fullWidth:!0,label:"Description",name:"description",value:u.description,onChange:l,multiline:!0,rows:3,margin:"normal"}),e.jsx(k,{control:e.jsx(S,{checked:u.isActive,name:"isActive",onChange:l}),label:"Active"}),e.jsx(k,{control:e.jsx(S,{checked:u.isFeatured,name:"isFeatured",onChange:l}),label:"Featured"}),e.jsxs(y,{sx:{mt:3,display:"flex",justifyContent:"flex-end",gap:1},children:[e.jsx(p,{onClick:r,children:"Cancel"}),e.jsx(T,{loading:C,variant:"contained",onClick:g,children:"Save"})]})]})})}function $({open:b,category:r,onClose:x,onSuccess:C}){const[c,d]=n.useState(!1),[s,u]=n.useState(null),[h,l]=n.useState({name:"",description:"",isActive:!0,isFeatured:!1}),g=a=>{const{name:o,value:m,checked:f,type:j}=a.target;l(w=>({...w,[o]:j==="checkbox"?f:m}))},i=async()=>{if(r)try{d(!0);const a=new FormData;Object.entries(h).forEach(([o,m])=>a.append(o,String(m))),a.append("categoryId",r._id),s&&a.append("image",s),await O(A.ADD_SUBCATEGORY,a,{authRequired:!0,headers:{"Content-Type":"multipart/form-data"}}),C(),x()}finally{d(!1)}};return e.jsx(R,{open:b,onClose:x,children:e.jsxs(y,{sx:{width:420,p:3,bgcolor:"background.paper",borderRadius:2,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:[e.jsx(v,{variant:"h6",mb:1,children:"New Sub Category"}),e.jsxs(v,{variant:"body2",color:"text.secondary",mb:2,children:["Parent Category: ",e.jsx("b",{children:r==null?void 0:r.name})]}),e.jsx(F,{fullWidth:!0,label:"Name",name:"name",value:h.name,onChange:g,margin:"normal"}),e.jsxs(p,{component:"label",variant:"outlined",sx:{my:2},children:[s?s.name:"Upload icon",e.jsx("input",{hidden:!0,type:"file",accept:"image/*",onChange:a=>{var o;return u(((o=a.target.files)==null?void 0:o[0])||null)}})]}),e.jsx(F,{fullWidth:!0,label:"Description",name:"description",value:h.description,onChange:g,multiline:!0,rows:3,margin:"normal"}),e.jsx(k,{control:e.jsx(S,{checked:h.isActive,name:"isActive",onChange:g}),label:"Active"}),e.jsx(k,{control:e.jsx(S,{checked:h.isFeatured,name:"isFeatured",onChange:g}),label:"Featured"}),e.jsxs(y,{sx:{mt:3,display:"flex",justifyContent:"flex-end",gap:1},children:[e.jsx(p,{onClick:x,children:"Cancel"}),e.jsx(T,{loading:c,variant:"contained",onClick:i,children:"Save"})]})]})})}function M(){const[b,r]=n.useState([]),[x,C]=n.useState([]),[c,d]=n.useState(null),[s,u]=n.useState("category"),[h,l]=n.useState(!1),[g,i]=n.useState(!1),[a,o]=n.useState(!1),m="https://india-collage-fest-api.onrender.com",f=n.useCallback(async()=>{try{l(!0);const t=await N(A.GET_CATEGORY,{authRequired:!0});r(t.data.category||[])}finally{l(!1)}},[]),j=async t=>{try{l(!0),d(t);const G=await N(A.GET_SUBCATEGORY_BY_CATEGORY(t._id),{authRequired:!0});C(G.data.subCategories||[]),u("subcategory")}finally{l(!1)}};n.useEffect(()=>{f()},[f]);const w=[{name:"Icon",width:"80px",cell:t=>e.jsx(I,{src:t.icon?`${m}${t.icon}`:"",variant:"rounded",sx:{width:40,height:40}})},{name:"Name",selector:t=>t.name,sortable:!0},{name:"Sub Categories",cell:t=>e.jsx(p,{size:"small",variant:"outlined",onClick:()=>j(t),children:t.subCategoryCount??0})},{name:"Status",cell:t=>t.isActive?"Active":"Inactive"},{name:"Featured",cell:t=>t.isFeatured?"Yes":"No"}],D=[{name:"Icon",width:"80px",cell:t=>e.jsx(I,{src:t.icon?`${m}${t.icon}`:"",variant:"rounded",sx:{width:40,height:40}})},{name:"Name",selector:t=>t.name,sortable:!0},{name:"Status",cell:t=>t.isActive?"Active":"Inactive"},{name:"Featured",cell:t=>t.isFeatured?"Yes":"No"}];return e.jsxs(Y,{children:[e.jsxs(y,{sx:{mb:3,display:"flex",alignItems:"center"},children:[e.jsx(v,{variant:"h4",sx:{flexGrow:1},children:s==="category"?"Categories":`Sub Categories of ${c==null?void 0:c.name}`}),s==="subcategory"&&e.jsx(p,{variant:"contained",color:"inherit",startIcon:e.jsx(E,{icon:"mingcute:add-line"}),onClick:()=>o(!0),children:"New Sub Category"}),s==="category"&&e.jsx(p,{variant:"contained",color:"inherit",startIcon:e.jsx(E,{icon:"mingcute:add-line"}),onClick:()=>i(!0),children:"New Category"})]}),s==="subcategory"&&e.jsx(p,{sx:{mb:2},variant:"outlined",onClick:()=>{u("category"),C([]),d(null)},children:"Back to Categories"}),e.jsx(B,{columns:s==="category"?w:D,data:s==="category"?b:x,progressPending:h,pagination:!0,highlightOnHover:!0,responsive:!0}),e.jsx(L,{open:g,onClose:()=>i(!1),onSuccess:f}),e.jsx($,{open:a,category:c,onClose:()=>o(!1),onSuccess:()=>j(c)})]})}function H(){return e.jsxs(e.Fragment,{children:[e.jsx("title",{children:`Categories - ${_.appName}`}),e.jsx(M,{})]})}export{H as default};
