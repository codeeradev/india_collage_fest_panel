import{$ as Ct,r,a0 as G,a1 as q,g as Y,m as X,k as K,j as n,h as M,c as xt,b as V,a2 as vt,E as Z,a3 as yt,l as St,n as A,a4 as bt,a5 as kt,O as R,Z as wt,B as O,o as J,p as D,I as jt,y as _,a6 as Et}from"./index-GbOaGgM0.js";import{C as Lt}from"./config-global-BwHnWRtc.js";import{X as Pt}from"./index.es-CeEWRC6t.js";import{p as z,E as I,g as Tt}from"./apiClient-i189rV0m.js";import{D as At}from"./content-OnO3XI0R.js";import{T as P}from"./TextField-BrPYWE6M.js";import{F as Rt}from"./FormControlLabel-DJ67-KM1.js";import{S as Ot}from"./Switch-cjtFEHns.js";import{L as It}from"./LoadingButton-DCjE8OPo.js";import{C as Mt}from"./Chip-DLB2M0Hz.js";import"./Select-BaJTgM_p.js";import"./SwitchBase-CT3IaKnp.js";function _t(t={}){const{autoHideDuration:e=null,disableWindowBlurListener:l=!1,onClose:o,open:u,resumeHideDuration:x}=t,C=Ct();r.useEffect(()=>{if(!u)return;function a(i){i.defaultPrevented||i.key==="Escape"&&(o==null||o(i,"escapeKeyDown"))}return document.addEventListener("keydown",a),()=>{document.removeEventListener("keydown",a)}},[u,o]);const d=G((a,i)=>{o==null||o(a,i)}),g=G(a=>{!o||a==null||C.start(a,()=>{d(null,"timeout")})});r.useEffect(()=>(u&&g(e),C.clear),[u,e,g,C]);const m=a=>{o==null||o(a,"clickaway")},c=C.clear,f=r.useCallback(()=>{e!=null&&g(x??e*.5)},[e,x,g]),S=a=>i=>{const p=a.onBlur;p==null||p(i),f()},v=a=>i=>{const p=a.onFocus;p==null||p(i),c()},b=a=>i=>{const p=a.onMouseEnter;p==null||p(i),c()},k=a=>i=>{const p=a.onMouseLeave;p==null||p(i),f()};return r.useEffect(()=>{if(!l&&u)return window.addEventListener("focus",f),window.addEventListener("blur",c),()=>{window.removeEventListener("focus",f),window.removeEventListener("blur",c)}},[l,u,f,c]),{getRootProps:(a={})=>{const i={...q(t),...q(a)};return{role:"presentation",...a,...i,onBlur:S(i),onFocus:v(i),onMouseEnter:b(i),onMouseLeave:k(i)}},onClickAway:m}}function Dt(t){return Y("MuiSnackbarContent",t)}X("MuiSnackbarContent",["root","message","action"]);const zt=t=>{const{classes:e}=t;return V({root:["root"],action:["action"],message:["message"]},Dt,e)},Bt=M(vt,{name:"MuiSnackbarContent",slot:"Root",overridesResolver:(t,e)=>e.root})(Z(({theme:t})=>{const e=t.palette.mode==="light"?.8:.98,l=yt(t.palette.background.default,e);return{...t.typography.body2,color:t.vars?t.vars.palette.SnackbarContent.color:t.palette.getContrastText(l),backgroundColor:t.vars?t.vars.palette.SnackbarContent.bg:l,display:"flex",alignItems:"center",flexWrap:"wrap",padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,flexGrow:1,[t.breakpoints.up("sm")]:{flexGrow:"initial",minWidth:288}}})),Ft=M("div",{name:"MuiSnackbarContent",slot:"Message",overridesResolver:(t,e)=>e.message})({padding:"8px 0"}),Nt=M("div",{name:"MuiSnackbarContent",slot:"Action",overridesResolver:(t,e)=>e.action})({display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}),Ht=r.forwardRef(function(e,l){const o=K({props:e,name:"MuiSnackbarContent"}),{action:u,className:x,message:C,role:d="alert",...g}=o,m=o,c=zt(m);return n.jsxs(Bt,{role:d,square:!0,elevation:6,className:xt(c.root,x),ownerState:m,ref:l,...g,children:[n.jsx(Ft,{className:c.message,ownerState:m,children:C}),u?n.jsx(Nt,{className:c.action,ownerState:m,children:u}):null]})});function Ut(t){return Y("MuiSnackbar",t)}X("MuiSnackbar",["root","anchorOriginTopCenter","anchorOriginBottomCenter","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft"]);const Wt=t=>{const{classes:e,anchorOrigin:l}=t,o={root:["root",`anchorOrigin${R(l.vertical)}${R(l.horizontal)}`]};return V(o,Ut,e)},$t=M("div",{name:"MuiSnackbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:l}=t;return[e.root,e[`anchorOrigin${R(l.anchorOrigin.vertical)}${R(l.anchorOrigin.horizontal)}`]]}})(Z(({theme:t})=>({zIndex:(t.vars||t).zIndex.snackbar,position:"fixed",display:"flex",left:8,right:8,justifyContent:"center",alignItems:"center",variants:[{props:({ownerState:e})=>e.anchorOrigin.vertical==="top",style:{top:8,[t.breakpoints.up("sm")]:{top:24}}},{props:({ownerState:e})=>e.anchorOrigin.vertical!=="top",style:{bottom:8,[t.breakpoints.up("sm")]:{bottom:24}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="left",style:{justifyContent:"flex-start",[t.breakpoints.up("sm")]:{left:24,right:"auto"}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="right",style:{justifyContent:"flex-end",[t.breakpoints.up("sm")]:{right:24,left:"auto"}}},{props:({ownerState:e})=>e.anchorOrigin.horizontal==="center",style:{[t.breakpoints.up("sm")]:{left:"50%",right:"auto",transform:"translateX(-50%)"}}}]}))),Gt=r.forwardRef(function(e,l){const o=K({props:e,name:"MuiSnackbar"}),u=St(),x={enter:u.transitions.duration.enteringScreen,exit:u.transitions.duration.leavingScreen},{action:C,anchorOrigin:{vertical:d,horizontal:g}={vertical:"bottom",horizontal:"left"},autoHideDuration:m=null,children:c,className:f,ClickAwayListenerProps:S,ContentProps:v,disableWindowBlurListener:b=!1,message:k,onBlur:w,onClose:a,onFocus:i,onMouseEnter:p,onMouseLeave:s,open:E,resumeHideDuration:B,slots:F={},slotProps:Q={},TransitionComponent:N,transitionDuration:H=x,TransitionProps:{onEnter:U,onExited:W,...tt}={},...et}=o,L={...o,anchorOrigin:{vertical:d,horizontal:g},autoHideDuration:m,disableWindowBlurListener:b,TransitionComponent:N,transitionDuration:H},nt=Wt(L),{getRootProps:ot,onClickAway:st}=_t({...L}),[at,$]=r.useState(!0),it=h=>{$(!0),W&&W(h)},rt=(h,y)=>{$(!1),U&&U(h,y)},T={slots:{transition:N,...F},slotProps:{content:v,clickAwayListener:S,transition:tt,...Q}},[lt,ct]=A("root",{ref:l,className:[nt.root,f],elementType:$t,getSlotProps:ot,externalForwardedProps:{...T,...et},ownerState:L}),[ut,{ownerState:dt,...pt}]=A("clickAwayListener",{elementType:bt,externalForwardedProps:T,getSlotProps:h=>({onClickAway:(...y)=>{var j;(j=h.onClickAway)==null||j.call(h,...y),st(...y)}}),ownerState:L}),[gt,mt]=A("content",{elementType:Ht,shouldForwardComponentProp:!0,externalForwardedProps:T,additionalProps:{message:k,action:C},ownerState:L}),[ft,ht]=A("transition",{elementType:kt,externalForwardedProps:T,getSlotProps:h=>({onEnter:(...y)=>{var j;(j=h.onEnter)==null||j.call(h,...y),rt(...y)},onExited:(...y)=>{var j;(j=h.onExited)==null||j.call(h,...y),it(...y)}}),additionalProps:{appear:!0,in:E,timeout:H,direction:d==="top"?"down":"up"},ownerState:L});return!E&&at?null:n.jsx(ut,{...pt,...F.clickAwayListener&&{ownerState:dt},children:n.jsx(lt,{...ct,children:n.jsx(ft,{...ht,children:c||n.jsx(gt,{...mt})})})})});function qt({open:t,onClose:e,onSuccess:l,city:o}){const u=!!o,[x,C]=r.useState(!1),[d,g]=r.useState({city:"",latitude:"",longitude:"",description:"",is_active:!0});r.useEffect(()=>{g(o?{city:o.city||"",latitude:o.latitude||"",longitude:o.longitude||"",description:o.description||"",is_active:o.is_active??!0}:{city:"",latitude:"",longitude:"",description:"",is_active:!0})},[o]);const m=f=>{const{name:S,value:v,checked:b,type:k}=f.target;g(w=>({...w,[S]:k==="checkbox"?b:v}))},c=async()=>{C(!0);try{let f;u?f=await z(I.EDIT_CITY(o._id),d,{authRequired:!0}):f=await z(I.ADD_CITY,d,{authRequired:!0}),l(f.data.message||"City saved"),e()}finally{C(!1)}};return n.jsx(wt,{open:t,onClose:e,children:n.jsxs(O,{sx:{width:420,p:3,bgcolor:"background.paper",borderRadius:2,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},children:[n.jsx(J,{variant:"h6",mb:2,children:u?"Edit City":"New City"}),n.jsx(P,{fullWidth:!0,label:"City",name:"city",value:d.city,onChange:m,margin:"normal"}),n.jsx(P,{fullWidth:!0,label:"Latitude",name:"latitude",value:d.latitude,onChange:m,margin:"normal"}),n.jsx(P,{fullWidth:!0,label:"Longitude",name:"longitude",value:d.longitude,onChange:m,margin:"normal"}),n.jsx(P,{fullWidth:!0,label:"Description",name:"description",value:d.description,onChange:m,multiline:!0,rows:3,margin:"normal"}),n.jsx(Rt,{control:n.jsx(Ot,{checked:d.is_active,name:"is_active",onChange:m}),label:"Active"}),n.jsxs(O,{sx:{mt:3,display:"flex",justifyContent:"flex-end",gap:1},children:[n.jsx(D,{onClick:e,children:"Cancel"}),n.jsx(It,{loading:x,variant:"contained",onClick:c,children:u?"Update":"Save"})]})]})})}function Yt(){const[t,e]=r.useState([]),[l,o]=r.useState(!1),[u,x]=r.useState(null),[C,d]=r.useState(!1),[g,m]=r.useState(""),[c,f]=r.useState("all"),[S,v]=r.useState(null),[b,k]=r.useState(null),w=r.useCallback(async()=>{try{o(!0);const s=await Tt(I.GET_CITY,{authRequired:!0});e(s.data.data||[])}finally{o(!1)}},[]);r.useEffect(()=>{w()},[w]);const a=async s=>{if(!b)try{k(s._id);const E=await z(I.EDIT_CITY(s._id),{is_active:!s.is_active},{authRequired:!0});v(E.data.message||"Status updated"),w()}finally{k(null)}},i=r.useMemo(()=>t.filter(s=>{const E=s.city.toLowerCase().includes(g.toLowerCase()),B=c==="all"||c==="active"&&s.is_active||c==="inactive"&&!s.is_active;return E&&B}),[t,g,c]),p=[{name:"City",selector:s=>s.city,sortable:!0},{name:"Latitude",selector:s=>s.latitude},{name:"Longitude",selector:s=>s.longitude},{name:"Status",cell:s=>n.jsx(Mt,{clickable:!0,size:"small",label:b===s._id?"Updating...":s.is_active?"Active":"Inactive",color:s.is_active?"success":"default",onClick:()=>a(s)})},{name:"Action",cell:s=>n.jsx(D,{size:"small",onClick:()=>{x(s),d(!0)},children:"Edit"})}];return n.jsxs(At,{children:[n.jsxs(O,{sx:{mb:4,display:"flex",alignItems:"center"},children:[n.jsx(J,{variant:"h4",sx:{flexGrow:1},children:"Cities"}),n.jsx(D,{variant:"contained",color:"inherit",startIcon:n.jsx(jt,{icon:"mingcute:add-line"}),onClick:()=>d(!0),children:"New City"})]}),n.jsxs(O,{sx:{mb:2,display:"flex",gap:2,justifyContent:"space-between"},children:[n.jsx(P,{size:"small",placeholder:"Search city...",value:g,onChange:s=>m(s.target.value),sx:{width:260}}),n.jsxs(P,{size:"small",select:!0,value:c,onChange:s=>f(s.target.value),sx:{width:180},children:[n.jsx(_,{value:"all",children:"All"}),n.jsx(_,{value:"active",children:"Active"}),n.jsx(_,{value:"inactive",children:"Inactive"})]})]}),n.jsx(Pt,{columns:p,data:i,progressPending:l,pagination:!0,highlightOnHover:!0,responsive:!0}),n.jsx(qt,{open:C,city:u,onClose:()=>{d(!1),x(null)},onSuccess:s=>{v(s),w()}}),n.jsx(Gt,{open:!!S,autoHideDuration:3e3,onClose:()=>v(null),children:n.jsx(Et,{severity:"success",onClose:()=>v(null),children:S})})]})}function ie(){return n.jsxs(n.Fragment,{children:[n.jsx("title",{children:`Cities - ${Lt.appName}`}),n.jsx(Yt,{})]})}export{ie as default};
